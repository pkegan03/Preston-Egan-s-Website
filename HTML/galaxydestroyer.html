<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galaxy Destroyer — Preston K. Egan</title>
    <link rel="stylesheet" href="../Styles/game.css">
</head>
<body>

    <!-- TOP NAV -->
    <header class="game-header">
        <div class="nav-container">
            <div class="logo">
                <span class="logo-main">Preston K. Egan</span>
                <span class="logo-sub">Galaxy Destroyer</span>
            </div>
            <nav class="main-nav">
                <a href="../index.html">Home</a>
                <a href="aboutme.html">About Me</a>
                <a href="Resume.html">Resume</a>
                <a href="contact.html">Contact</a>
                <a href="BYUathletics.html">BYU Athletics</a>
                <a href="galaxydestroyer.html" class="active">Galaxy Destroyer</a>
            </nav>
        </div>
    </header>

    <!-- MAIN -->
    <main class="game-main">
        <section class="game-intro">
            <h1>Galaxy Destroyer</h1>
            <p>
                Defend your sector of space from incoming enemy formations. Move horizontally to stay clear 
                of danger and launch precise shots to eliminate each ship before it reaches your position.
                The game is built with HTML5 canvas and simple, responsive controls.
            </p>
        </section>

        <section class="game-layout">
            <!-- GAME PANEL -->
            <div class="game-panel">
                <div class="game-bar">
                    <span id="score">Score: 0</span>
                    <button id="reset-button">Reset Game</button>
                </div>
                <canvas id="game-canvas" width="700" height="420"></canvas>
                <p id="status-message">
                    Use the left and right arrow keys (or A and D) to move. Press the spacebar to fire.
                    Clear all enemy ships to win.
                </p>
            </div>

            <!-- INFO PANEL -->
            <aside class="info-panel">
                <h2>Controls</h2>
                <ul>
                    <li><strong>Move:</strong> Left / Right arrows or A / D</li>
                    <li><strong>Fire:</strong> Spacebar</li>
                </ul>

                <h2>Objective</h2>
                <p>
                    Destroy every enemy ship on the screen before they reach the lower edge of the play area.
                    Positioning, timing, and short, controlled movements are more effective than holding a key.
                </p>

                <h2>Details</h2>
                <p>
                    Galaxy Destroyer is a small project that demonstrates core ideas in web-based game development:
                    drawing to the canvas, handling keyboard input, updating game state, and checking collisions
                    between objects.
                </p>
            </aside>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="game-footer">
        <p>© 2025 Preston Egan's Website</p>
    </footer>

    <!-- GAME SCRIPT -->
    <script>
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const statusElement = document.getElementById('status-message');
        const resetButton = document.getElementById('reset-button');

        const WIDTH = canvas.width;
        const HEIGHT = canvas.height;

        // Ship
        const shipWidth = 42;
        const shipHeight = 16;
        const shipSpeed = 6;
        let shipX = WIDTH / 2 - shipWidth / 2;
        const shipY = HEIGHT - 50;

        // Bullets
        const bulletWidth = 4;
        const bulletHeight = 10;
        const bulletSpeed = 8;
        let bullets = [];

        // Enemies
        const enemyRows = 4;
        const enemyCols = 8;
        const enemyWidth = 40;
        const enemyHeight = 20;
        const enemyXSpacing = 70;
        const enemyYSpacing = 40;
        const enemyStartX = 60;
        const enemyStartY = 40;
        let enemies = [];
        let enemyDirection = 1;
        let enemySpeed = 1.5;
        const enemyDropDistance = 20;

        let keys = {};
        let score = 0;
        let gameOver = false;
        let gameWon = false;

        function createEnemies() {
            enemies = [];
            for (let row = 0; row < enemyRows; row++) {
                for (let col = 0; col < enemyCols; col++) {
                    enemies.push({
                        x: enemyStartX + col * enemyXSpacing,
                        y: enemyStartY + row * enemyYSpacing,
                        alive: true
                    });
                }
            }
        }

        function resetGame() {
            shipX = WIDTH / 2 - shipWidth / 2;
            bullets = [];
            enemyDirection = 1;
            enemySpeed = 1.5;
            createEnemies();
            score = 0;
            gameOver = false;
            gameWon = false;
            scoreElement.textContent = 'Score: ' + score;
            statusElement.textContent =
                'Use the left/right arrows or A/D to move. Press spacebar to fire. Clear all enemy ships to win.';
        }

        function drawShip() {
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(shipX, shipY, shipWidth, shipHeight);
            ctx.beginPath();
            ctx.moveTo(shipX, shipY);
            ctx.lineTo(shipX + shipWidth / 2, shipY - 10);
            ctx.lineTo(shipX + shipWidth, shipY);
            ctx.closePath();
            ctx.fill();
        }

        function drawBullets() {
            ctx.fillStyle = '#4fc3f7';
            bullets.forEach(bullet => {
                ctx.fillRect(bullet.x, bullet.y, bulletWidth, bulletHeight);
            });
        }

        function drawEnemies() {
            ctx.fillStyle = 'rgb(30, 84, 155)';
            enemies.forEach(enemy => {
                if (enemy.alive) {
                    ctx.fillRect(enemy.x, enemy.y, enemyWidth, enemyHeight);
                }
            });
        }

        function updateShip() {
            if (keys['ArrowLeft'] || keys['a'] || keys['A']) {
                shipX -= shipSpeed;
            }
            if (keys['ArrowRight'] || keys['d'] || keys['D']) {
                shipX += shipSpeed;
            }
            if (shipX < 10) shipX = 10;
            if (shipX + shipWidth > WIDTH - 10) shipX = WIDTH - 10 - shipWidth;
        }

        function updateBullets() {
            bullets.forEach(b => b.y -= bulletSpeed);
            bullets = bullets.filter(b => b.y + bulletHeight > 0);
        }

        function updateEnemies() {
            let shouldDrop = false;

            enemies.forEach(enemy => {
                if (!enemy.alive) return;
                enemy.x += enemyDirection * enemySpeed;
                if (enemy.x < 10 || enemy.x + enemyWidth > WIDTH - 10) {
                    shouldDrop = true;
                }
            });

            if (shouldDrop) {
                enemyDirection *= -1;
                enemies.forEach(enemy => {
                    if (!enemy.alive) return;
                    enemy.y += enemyDropDistance;
                    if (enemy.y + enemyHeight >= shipY) {
                        gameOver = true;
                        statusElement.textContent =
                            'Enemies reached your position. Press "Reset Game" to try again.';
                    }
                });
            }
        }

        function checkCollisions() {
            bullets.forEach(bullet => {
                enemies.forEach(enemy => {
                    if (!enemy.alive) return;
                    if (
                        bullet.x < enemy.x + enemyWidth &&
                        bullet.x + bulletWidth > enemy.x &&
                        bullet.y < enemy.y + enemyHeight &&
                        bullet.y + bulletHeight > enemy.y
                    ) {
                        enemy.alive = false;
                        bullet.hit = true;
                        score += 50;
                        scoreElement.textContent = 'Score: ' + score;
                    }
                });
            });

            bullets = bullets.filter(bullet => !bullet.hit);

            if (enemies.every(e => !e.alive)) {
                gameWon = true;
                statusElement.textContent =
                    'You destroyed all enemy ships! Press "Reset Game" to play again.';
            }
        }

        function gameLoop() {
            ctx.clearRect(0, 0, WIDTH, HEIGHT);

            if (!gameOver && !gameWon) {
                updateShip();
                updateBullets();
                updateEnemies();
                checkCollisions();
            }

            drawShip();
            drawBullets();
            drawEnemies();

            requestAnimationFrame(gameLoop);
        }

        // KEY HANDLING – prevent page scroll when using arrows/space
        document.addEventListener('keydown', (e) => {
            const controlKeys = [
                'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown',
                ' ', 'Spacebar', 'a', 'A', 'd', 'D'
            ];
            if (controlKeys.includes(e.key)) {
                e.preventDefault();
            }

            keys[e.key] = true;

            if ((e.key === ' ' || e.key === 'Spacebar') && !gameOver && !gameWon) {
                bullets.push({
                    x: shipX + shipWidth / 2 - bulletWidth / 2,
                    y: shipY - bulletHeight
                });
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        resetButton.addEventListener('click', resetGame);

        // Start
        resetGame();
        requestAnimationFrame(gameLoop);
    </script>

</body>
</html>
